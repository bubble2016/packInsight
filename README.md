# 打包站智能分析系统 (PackInsight) v8.3

一款专为物流打包中转站打造的现代化智能数据分析平台。通过全自动化的数据清洗、多维度成本核算与交互式可视化报表，助力运营决策更加精准高效。

![Python Version](https://img.shields.io/badge/python-3.8%2B-blue)
![License](https://img.shields.io/badge/license-MIT-green)
![Status](https://img.shields.io/badge/status-stable-success)

## 🌟 核心亮点

PackInsight v8.3 经过全新模块化重构，具备以下核心优势：

*   **🚀 极速启动 & 模块化架构**：采用精细化的模块加载与缓存机制，冷启动体验极佳，资源占用更低。
*   **🧹 智能数据清洗**：内置强大的数据验证引擎，自动识别并过滤异常数据（如价格逻辑错误、必填项缺失），确保分析结果准确可靠。
*   **📊 交互式可视化仪表板**：基于 Plotly 打造的动态 HTML 仪表板，支持缩放、筛选与悬停交互。
    *   **桑基图 (Sankey Diagram)**：直观展示货物流向脉络。
    *   **日度趋势与 AI 预测**：即时掌握发货量波动。
    *   **气泡图与热力图**：全方位透视利润与成本分布。
*   **📉 深度成本与利润分析**：自动计算单吨利润、运费占比，精准定位亏损品类与路线，提供智能止损建议。
*   **🔄 多月度对比模式**：支持同时选择多个月份数据，自动生成环比增长报告，趋势变化一目了然。
*   **💾 磁盘级持久化缓存**：独创的数据缓存与断点恢复机制，大幅提升重复分析效率，防止意外中断导致的数据丢失。

## 🛠️ 技术栈

本项目主要基于以下技术构建：

-   **核心语言**: Python 3
-   **GUI 框架**: Tkinter (原生界面，轻量且跨平台)
-   **数据处理**: Pandas, NumPy (高性能科学计算)
-   **统计分析**: SciPy (高级统计模型)
-   **可视化引擎**: Plotly (生成交互式 HTML 报表)
-   **IO 支持**: OpenPyXL (Excel 读写)

## 📂 项目结构

```
PackInsight/
├── main.py                # 程序主入口
├── config.py              # 全局配置文件
├── requirements.txt       # 项目依赖
├── core/                  # 核心基础模块 (日志、缓存、性能监控)
├── data/                  # 数据处理模块 (加载、清洗、验证)
├── analysis/              # 业务分析模块 (成本、汇总、对比)
├── visualization/         # 可视化图表生成 (Plotly)
├── report/                # HTML 报告构建
├── gui/                   # 图形界面逻辑
└── logo.ico               # 应用程序图标
```

## 🚀 快速开始

### 1. 环境准备

确保你的电脑已安装 Python 3.8 或更高版本。

```bash
# 克隆项目到本地
git clone https://github.com/bubble2016/packInsight.git

# 进入项目目录
cd packInsight

# 安装依赖
pip install -r requirements.txt
```

### 2. 运行程序

直接运行 `main.py` 启动程序：

```bash
python main.py
```

### 3. 操作流程

1.  程序启动后，会进行环境自检。
2.  在弹出的文件对话框中，选择你需要分析的 Excel 原始数据表。
3.  系统会自动识别 Sheet 页，你可以选择**单个月份**进行深度分析，或选择**多个月份**进行对比分析。
4.  等待进度条完成，系统将自动生成以下文件到你的桌面 `月度智能分析报告` 文件夹：
    *   `*_仪表板_*.html`: 包含所有动态图表的交互式看板。
    *   `*_深度报告_*.html`: 文字版详细分析报告与建议。
    *   `*_清洗后数据_*.xlsx`: 经过清洗和标准化处理的源数据备份。

## 📝 更新日志

### v8.3 (Current)
*   重构核心架构，实现完全模块化。
*   引入磁盘缓存机制，重复加载速度提升 10 倍。
*   新增“亏损路线预警”与“车辆绩效评分”模型。
*   优化 HTML 报告样式，适配深色模式。

## 👤 作者

**李小泡**

如有任何问题或建议，欢迎提交 Issue 或联系作者。

---
*Happy Coding & Smart Packing!* 📦✨
